; generated by Component: ARM Compiler 5.06 update 6 (build 750) Tool: ArmCC [4d3637]
; commandline ArmCC [--list --split_sections --debug -c --asm --interleave -o..\output\tim6.o --asm_dir=..\Listing\ --list_dir=..\Listing\ --depend=..\output\tim6.d --cpu=Cortex-M4.fp --apcs=interwork -O1 --diag_suppress=9931,870 -I..\APP -I..\drive -I..\Include -I..\Libraries\CMSIS\inc -I..\Libraries\CMSIS\src -I..\Libraries\FWlib\inc -I..\Libraries\FWlib\src -I..\Listing -I..\Output -I..\Project -I..\STemWinLibrary522\Config -I..\STemWinLibrary522\emWinTask -I..\STemWinLibrary522\GUILib -I..\STemWinLibrary522\inc -I..\User -I..\USB\STM32_USB_HOST_Library\Class\HID\inc -I..\USB\STM32_USB_HOST_Library\Class\MSC\src -I..\USB\STM32_USB_HOST_Library\Core\src -I..\USB\USB_APP -I..\USB\STM32_USB_HOST_Library\Class\HID\src -I..\USB\STM32_USB_HOST_Library\Class\MSC\inc -I..\USB\STM32_USB_HOST_Library\Core\inc -I..\USB\STM32_USB_OTG_Driver\inc -I..\FATFS\exfuns -I..\FATFS\src\option -I..\FATFS\src -I..\MALLOC -I..\FATFS -I..\IAP -ID:\Keil_v5\ARM\RV31\INC -ID:\Keil_v5\ARM\CMSIS\Include -ID:\Keil_v5\ARM\INC\ST\STM32F4xx -D__UVISION_VERSION=525 -DUSE_STDPERIPH_DRIVER -DSTM32F40XX -DUSE_USB_OTG_FS -DUSE_EMBEDDED_PHY -DUSE_USB_OTG_HS -DSTM32F40XX --omf_browse=..\output\tim6.crf --no_multibyte_chars ..\drive\TIM6.c]
                          THUMB

                          AREA ||i.MODS_Poll||, CODE, READONLY, ALIGN=2

                  MODS_Poll PROC
;;;666    
;;;667    void MODS_Poll(void)
000000  b510              PUSH     {r4,lr}
;;;668    {
;;;669    	uint16_t addr;
;;;670    	static uint16_t crc1;
;;;671        static u32 testi;
;;;672    	/* è¶…è¿‡3.5ä¸ªå­—ç¬¦æ—¶é—´åŽæ‰§è¡ŒMODH_RxTimeOut()å‡½æ•°ã€‚å…¨å±€å˜é‡ g_rtu_timeout = 1; é€šçŸ¥ä¸»ç¨‹åºå¼€å§‹è§£ç ?*/
;;;673    //	if (g_mods_timeout == 0)	
;;;674    //	{
;;;675    //		return;								/* æ²¡æœ‰è¶…æ—¶ï¼Œç»§ç»­æŽ¥æ”¶ã€‚ä¸è¦æ¸…é›?g_tModS.RxCount */
;;;676    //	}
;;;677    
;;;678        testi=g_tModS.RxCount;
000002  4c13              LDR      r4,|L1.80|
000004  4a13              LDR      r2,|L1.84|
000006  f894009e          LDRB     r0,[r4,#0x9e]  ; g_tModS
00000a  61d0              STR      r0,[r2,#0x1c]  ; testi
;;;679        testi=g_tModS.RxCount;
;;;680        testi=g_tModS.RxCount;
;;;681    	if(testi>7)				/* ½ÓÊÕµ½µÄÊý¾ÝÐ¡ÓÚ4¸ö×Ö½Ú¾ÍÈÏÎª´íÎó */
;;;682    	{
;;;683    		testi=testi;
;;;684    	}
;;;685    	testi=g_tModS.RxCount;
;;;686        if(testi==8)				/* ½ÓÊÕµ½µÄÊý¾ÝÐ¡ÓÚ4¸ö×Ö½Ú¾ÍÈÏÎª´íÎó */
00000c  2808              CMP      r0,#8
00000e  d101              BNE      |L1.20|
;;;687    	{
;;;688    		testi=testi+1;
000010  2109              MOVS     r1,#9
000012  61d1              STR      r1,[r2,#0x1c]  ; testi
                  |L1.20|
;;;689    	}
;;;690    	//ÅÐ¶ÏÍ¨Ñ¶½ÓÊÕÊÇ·ñ³¬Ê±
;;;691    	if(OldTick!=Tick_10ms)
000014  6a13              LDR      r3,[r2,#0x20]  ; OldTick
000016  6911              LDR      r1,[r2,#0x10]  ; Tick_10ms
000018  428b              CMP      r3,r1
00001a  d014              BEQ      |L1.70|
;;;692      	{  
;;;693    	  OldTick=Tick_10ms;
00001c  6211              STR      r1,[r2,#0x20]  ; OldTick
;;;694    	   if(g_mods_timeout>0)
00001e  4a0e              LDR      r2,|L1.88|
000020  7811              LDRB     r1,[r2,#0]  ; g_mods_timeout
000022  b109              CBZ      r1,|L1.40|
;;;695          { 
;;;696    	    g_mods_timeout--;
000024  1e49              SUBS     r1,r1,#1
000026  7011              STRB     r1,[r2,#0]
                  |L1.40|
;;;697          }
;;;698    	  if(g_mods_timeout==0 && g_tModS.RxCount>0)   //ÓÐÊýµ«³¬Ê±ÁË
000028  7811              LDRB     r1,[r2,#0]  ; g_mods_timeout
00002a  2900              CMP      r1,#0
00002c  d10b              BNE      |L1.70|
00002e  2800              CMP      r0,#0
000030  d009              BEQ      |L1.70|
;;;699          { 
;;;700    		// goto err_ret;
;;;701    	
;;;702          }
;;;703          else if(g_mods_timeout==0 && g_tModS.RxCount==0) //Ã»Êý³¬Ê±ÁË
;;;704             return;
;;;705          else //Ã»³¬Ê±ÁË£¬¼ÌÐøÊÕ
;;;706             return;
;;;707    	}
;;;708    	else   //Ã»ÓÐµ½10ms£¬²»½øÈë½âÎö
;;;709    		return;
;;;710    	//g_mods_timeout = 0;	 					/* Çå±êÖ¾ */
;;;711    
;;;712    	if (g_tModS.RxCount < 4)				/* ½ÓÊÕµ½µÄÊý¾ÝÐ¡ÓÚ4¸ö×Ö½Ú¾ÍÈÏÎª´íÎó */
000032  2804              CMP      r0,#4
000034  d304              BCC      |L1.64|
;;;713    	{
;;;714    		goto err_ret;
;;;715    	}
;;;716    
;;;717    	/* ¼ÆËãCRCÐ£ÑéºÍ */
;;;718    // 	crc1 = CRC16(g_tModS.RxBuf, g_tModS.RxCount);
;;;719    // 	if (crc1 != 0)
;;;720    // 	{
;;;721    // 		goto err_ret;
;;;722    // 	}
;;;723    
;;;724    // 	/* Õ¾µØÖ· (1×Ö½Ú£© */
;;;725    // 	addr = g_tModS.RxBuf[0];				/* µÚ1×Ö½Ú Õ¾ºÅ */
;;;726    // 	if (addr != SADDR485)		 			/* ÅÐ¶ÏÖ÷»ú·¢ËÍµÄÃüÁîµØÖ·ÊÇ·ñ·ûºÏ */
;;;727    // 	{
;;;728    // 		goto err_ret;
;;;729    // 	}
;;;730    
;;;731    	/* åˆ†æžåº”ç”¨å±‚åè®?*/
;;;732        if(g_tModS.RxBuf[2] == 0xA5)
000036  78a0              LDRB     r0,[r4,#2]  ; g_tModS
000038  28a5              CMP      r0,#0xa5
00003a  d005              BEQ      |L1.72|
;;;733        {
;;;734            UART_Action();
;;;735        }else{
;;;736    //        usartocflag = 1;
;;;737            RecHandle();
00003c  f7fffffe          BL       RecHandle
                  |L1.64|
;;;738        }
;;;739    							
;;;740    	
;;;741    err_ret:
;;;742    #if 0										/* æ­¤éƒ¨åˆ†ä¸ºäº†ä¸²å£æ‰“å°ç»“æž?å®žé™…è¿ç”¨ä¸­å¯ä¸è¦ */
;;;743    	g_tPrint.Rxlen = g_tModS.RxCount;
;;;744    	memcpy(g_tPrint.RxBuf, g_tModS.RxBuf, g_tModS.RxCount);
;;;745    #endif
;;;746    	
;;;747     	g_tModS.RxCount = 0;					/* å¿…é¡»æ¸…é›¶è®¡æ•°å™¨ï¼Œæ–¹ä¾¿ä¸‹æ¬¡å¸§åŒæ­?*/
000040  2000              MOVS     r0,#0
000042  f884009e          STRB     r0,[r4,#0x9e]
                  |L1.70|
;;;748    }
000046  bd10              POP      {r4,pc}
                  |L1.72|
000048  f7fffffe          BL       UART_Action
00004c  e7f8              B        |L1.64|
;;;749    
                          ENDP

00004e  0000              DCW      0x0000
                  |L1.80|
                          DCD      g_tModS
                  |L1.84|
                          DCD      ||.data||
                  |L1.88|
                          DCD      g_mods_timeout

                          AREA ||i.TIM3_IRQHandler||, CODE, READONLY, ALIGN=2

                  TIM3_IRQHandler PROC
;;;483    //??? 3 ??????
;;;484    void TIM3_IRQHandler(void)
000000  b510              PUSH     {r4,lr}
;;;485    {
;;;486        static vu8 calert = 0;
;;;487        static vu16 resetcount;
;;;488        static vu8 read1963;
;;;489        static vu16 scancount;
;;;490        static vu32 ctime,dctime;
;;;491        
;;;492        if(TIM_GetITStatus(TIM3,TIM_IT_Update)==SET) //????
000002  4c07              LDR      r4,|L2.32|
000004  2101              MOVS     r1,#1
000006  4620              MOV      r0,r4
000008  f7fffffe          BL       TIM_GetITStatus
00000c  2801              CMP      r0,#1
00000e  d105              BNE      |L2.28|
;;;493        {
;;;494            TIM_ClearITPendingBit(TIM3,TIM_IT_Update); //??????¦Ë
000010  2101              MOVS     r1,#1
000012  4620              MOV      r0,r4
000014  f7fffffe          BL       TIM_ClearITPendingBit
;;;495    //         if(page_sw != face_starter)
;;;496    //         {
;;;497    //              if(resetflag == 1)
;;;498    //              {
;;;499    //                  if(resetcount == 1)
;;;500    //                  {
;;;501    //                      LCD_Initializtion();
;;;502    //                      sLCD_WR_REG(0xf1);
;;;503    //                      GUI_Init();
;;;504    //                      if(page_sw == face_menu)
;;;505    //                      {
;;;506    //                          ResetPow();
;;;507    //                      }else if(page_sw == face_cdc){
;;;508    //                          ResetCDC();
;;;509    //                      }else if(page_sw == face_r){
;;;510    //                          ResetR();
;;;511    //                      }else if(page_sw == face_load){
;;;512    //                          ResetLoad();
;;;513    //                      }else if(page_sw == face_graph){
;;;514    //                          ResetG();
;;;515    //                      }else if(page_sw == face_set){
;;;516    //                          ResetSET();
;;;517    //                      }
;;;518    //                      resdone = 1;
;;;519    // //                     resetflag = 0;
;;;520    //                      resetcount = 0;
;;;521    //                  }else{
;;;522    //                      resetcount++;
;;;523    //                  }                
;;;524    //              }
;;;525    //          }
;;;526            switch(page_sw)
000018  4802              LDR      r0,|L2.36|
00001a  7800              LDRB     r0,[r0,#0]  ; page_sw
                  |L2.28|
;;;527            {
;;;528    //            case face_menu:
;;;529    //            {
;;;530    //                if(pow_sw == pow_on)
;;;531    //                {
;;;532    //                    bc_raw += DISS_POW_Current * 1000 * 1/3600;
;;;533    //                }else{
;;;534    //                    bc_raw = 0;
;;;535    //                }
;;;536    //            }break;
;;;537    //            case face_cdc:
;;;538    //            {
;;;539    //                if(mode_sw == mode_pow && cdc_sw == cdc_on)
;;;540    //                {
;;;541    //                    ctime++;
;;;542    //                    second = ctime%60;//ç§’
;;;543    //                    minute = (ctime/60)%60;//åˆ†
;;;544    //                    hour   = ctime/3600;//æ—¶
;;;545    //                    cbc_raw += DISS_POW_Current * 1000 * 1/3600;
;;;546    //                    bc_raw = 0;
;;;547    ////                    bc_raw += DISS_POW_Current * 1000 * 1/3600;
;;;548    //                }else if(mode_sw == mode_load && cdc_sw == cdc_on){
;;;549    //                    dctime++;
;;;550    //                    second1 = dctime%60;//ç§’
;;;551    //                    minute1 = (dctime/60)%60;//åˆ†
;;;552    //                    hour1   = dctime/3600;//æ—¶
;;;553    //                    bc_raw += DISS_Current * 1000 * 1/3600;
;;;554    ////                    c_sum += DISS_Current * 1000 * 1/3600;
;;;555    //                    cbc_raw = 0;
;;;556    //                }else if(cdc_sw == cdc_off){
;;;557    //                    bc_raw = 0;
;;;558    //                    cbc_raw = 0;
;;;559    //                    c_sum = 0;
;;;560    //                    ctime=0;
;;;561    //                    dctime=0;
;;;562    //                }
;;;563    //            }break;
;;;564    //            case face_load:
;;;565    //            {
;;;566    //                if(load_sw == load_on)
;;;567    //                {
;;;568    //                    if(alert_flag == 1)
;;;569    //                    {
;;;570    //                        calert ++;
;;;571    //                        if(calert == 3)
;;;572    //                        {
;;;573    //                            t_onoff = 0;
;;;574    //                            GPIO_SetBits(GPIOA,GPIO_Pin_15);//????OFF
;;;575    //                            mode_sw = 0;
;;;576    //                            load_sw = load_off;
;;;577    //                            calert = 0;                                
;;;578    //                        }
;;;579    //                    }
;;;580    //                    bc_raw += DISS_Current * 1000 * 1/3600;
;;;581    //                }else{
;;;582    //                    bc_raw = 0;
;;;583    //                }
;;;584    //            }break;
;;;585    //            case face_graph:
;;;586    //            {
;;;587    //                if(mode_sw == mode_pow)
;;;588    //                {
;;;589    //                    if(pow_sw == pow_on)
;;;590    //                    {
;;;591    //                        bc_raw += DISS_POW_Current * 1000 * 1/3600;
;;;592    //                    }else if(mode_sw == mode_pow && cdc_sw == cdc_on)
;;;593    //                    {
;;;594    //                        bc_raw += DISS_POW_Current * 1000 * 1/3600;
;;;595    //                    }
;;;596    //                    else{
;;;597    //                        bc_raw = 0;
;;;598    //                    }
;;;599    //                }               
;;;600    //                
;;;601    //                if(mode_sw == mode_load)
;;;602    //                {
;;;603    //                    if(load_sw == load_on)
;;;604    //                    {
;;;605    //                        bc_raw += DISS_Current * 1000 * 1/3600;
;;;606    //                    }else{
;;;607    //                        bc_raw = 0;
;;;608    //                    }
;;;609    //                }
;;;610    //            }break;
;;;611    //            case face_r:
;;;612    //            {
;;;613    //                if(oct_sw == oct_on)
;;;614    //                {
;;;615    //                    if(alert_flag == 1)
;;;616    //                    {
;;;617    //                        calert ++;
;;;618    //                        if(calert == 3)
;;;619    //                        {
;;;620    //                            ocstop = 1;
;;;621    //                            calert = 0;
;;;622    //                        }
;;;623    //                    }
;;;624    //                }
;;;625    //            }break;
;;;626            }
;;;627    //         GPIO_ResetBits(GPIOD,GPIO_Pin_12);
;;;628    //         TM1650_SET_LED(0x48,0x71);
;;;629    //         TM1650_SET_LED(0x68,0xF2);//PASS?
;;;630        }    
;;;631        
;;;632    }
00001c  bd10              POP      {r4,pc}
;;;633    
                          ENDP

00001e  0000              DCW      0x0000
                  |L2.32|
                          DCD      0x40000400
                  |L2.36|
                          DCD      page_sw

                          AREA ||i.TIM3_Int_Init||, CODE, READONLY, ALIGN=2

                  TIM3_Int_Init PROC
;;;463    //?o???¡¦??? 3!
;;;464    void TIM3_Int_Init(u16 arr,u16 psc)
000000  b57f              PUSH     {r0-r6,lr}
;;;465    {
000002  4604              MOV      r4,r0
000004  460d              MOV      r5,r1
;;;466        TIM_TimeBaseInitTypeDef TIM_TimeBaseInitStructure;
;;;467        NVIC_InitTypeDef NVIC_InitStructure;
;;;468        
;;;469        RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM3,ENABLE); //¨´?? TIM3 ??
000006  2101              MOVS     r1,#1
000008  2002              MOVS     r0,#2
00000a  f7fffffe          BL       RCC_APB1PeriphClockCmd
;;;470        TIM_TimeBaseInitStructure.TIM_Period = arr; //??????
00000e  9402              STR      r4,[sp,#8]
;;;471        TIM_TimeBaseInitStructure.TIM_Prescaler=psc; //?????
000010  f8ad5004          STRH     r5,[sp,#4]
;;;472        TIM_TimeBaseInitStructure.TIM_CounterMode=TIM_CounterMode_Up; //§Ó?????
000014  2000              MOVS     r0,#0
000016  f8ad0006          STRH     r0,[sp,#6]
;;;473        TIM_TimeBaseInitStructure.TIM_ClockDivision=TIM_CKD_DIV1;
00001a  f8ad000c          STRH     r0,[sp,#0xc]
;;;474        TIM_TimeBaseInit(TIM3,&TIM_TimeBaseInitStructure);// ¨²?????? TIM3
00001e  4c0e              LDR      r4,|L3.88|
000020  a901              ADD      r1,sp,#4
000022  4620              MOV      r0,r4
000024  f7fffffe          BL       TIM_TimeBaseInit
;;;475        TIM_ITConfig(TIM3,TIM_IT_Update,ENABLE); //?????? 3 ?§ä??
000028  2201              MOVS     r2,#1
00002a  4611              MOV      r1,r2
00002c  4620              MOV      r0,r4
00002e  f7fffffe          BL       TIM_ITConfig
;;;476        NVIC_InitStructure.NVIC_IRQChannel=TIM3_IRQn; //??? 3 ??
000032  211d              MOVS     r1,#0x1d
000034  f88d1000          STRB     r1,[sp,#0]
;;;477        NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority=0x01; //????? 1
000038  2101              MOVS     r1,#1
00003a  f88d1001          STRB     r1,[sp,#1]
;;;478        NVIC_InitStructure.NVIC_IRQChannelSubPriority=0x03; //§¾???? 3
00003e  2203              MOVS     r2,#3
000040  f88d2002          STRB     r2,[sp,#2]
;;;479        NVIC_InitStructure.NVIC_IRQChannelCmd=ENABLE;
000044  f88d1003          STRB     r1,[sp,#3]
;;;480        NVIC_Init(&NVIC_InitStructure);// ¨¹??? NVIC
000048  4668              MOV      r0,sp
00004a  f7fffffe          BL       NVIC_Init
;;;481        TIM_Cmd(TIM3,ENABLE); //Y????? 3
00004e  2101              MOVS     r1,#1
000050  4620              MOV      r0,r4
000052  f7fffffe          BL       TIM_Cmd
;;;482    }
000056  bd7f              POP      {r0-r6,pc}
;;;483    //??? 3 ??????
                          ENDP

                  |L3.88|
                          DCD      0x40000400

                          AREA ||i.TIM4_IRQHandler||, CODE, READONLY, ALIGN=2

                  TIM4_IRQHandler PROC
;;;95     //??? 3 ??????
;;;96     void TIM4_IRQHandler(void)
000000  e92d5ff0          PUSH     {r4-r12,lr}
;;;97     {
000004  ed2d8b06          VPUSH    {d8-d10}
;;;98         static vu16 resetcount;
;;;99         static vu8 read1963;
;;;100        static vu16 scancount;
;;;101        static vu16 uocount;
;;;102        static vu16 powcount;
;;;103        static vu16 powflag;
;;;104        static vu16 finishflag;
;;;105        static float crec1,crec2;
;;;106        u8 crec[6];
;;;107        u8 *csend;
;;;108        static u8 *sendbuf;
;;;109        u8 sendlen;
;;;110        static u16 recrc;
;;;111        static u16 scrc;
;;;112    	static vu8 staticloadflag,staticpowflag;
;;;113        u8 i;
;;;114    //     static float crec1,crec2;
;;;115        
;;;116        if(TIM_GetITStatus(TIM4,TIM_IT_Update)==SET) //????
000008  2101              MOVS     r1,#1
00000a  4cfe              LDR      r4,|L4.1028|
00000c  4620              MOV      r0,r4
00000e  f7fffffe          BL       TIM_GetITStatus
000012  2801              CMP      r0,#1
000014  d173              BNE      |L4.254|
;;;117        {
;;;118            TIM_ClearITPendingBit(TIM4,TIM_IT_Update); //Çå³ýÖÐ¶Ï±êÖ¾Î»
000016  2101              MOVS     r1,#1
000018  4620              MOV      r0,r4
00001a  f7fffffe          BL       TIM_ClearITPendingBit
;;;119            
;;;120            if(page_sw != face_starter)
00001e  4dfa              LDR      r5,|L4.1032|
000020  7828              LDRB     r0,[r5,#0]  ; page_sw
000022  2400              MOVS     r4,#0
;;;121            {
;;;122                 if(resetflag == 1)
000024  4ef9              LDR      r6,|L4.1036|
000026  2806              CMP      r0,#6                 ;120
000028  d00a              BEQ      |L4.64|
00002a  78b0              LDRB     r0,[r6,#2]  ; resetflag
00002c  2801              CMP      r0,#1
00002e  d107              BNE      |L4.64|
;;;123                 {
;;;124                     if(resetcount == 3000)
000030  88b1              LDRH     r1,[r6,#4]  ; resetcount
000032  f5a16030          SUB      r0,r1,#0xb00
000036  38b8              SUBS     r0,r0,#0xb8
000038  d012              BEQ      |L4.96|
;;;125                     {
;;;126    //                     sLCD_GPIO_Config();
;;;127                         sLCD_Init();
;;;128    //                     sLCD_WR_REG(0xf1);
;;;129                         GUI_Init();
;;;130                         if(page_sw == face_menu)
;;;131                         {
;;;132                             ResetPow();
;;;133                         }else if(page_sw == face_cdc){
;;;134                             ResetCDC();
;;;135                         }else if(page_sw == face_r){
;;;136                             ResetR();
;;;137                         }else if(page_sw == face_load){
;;;138                             ResetLoad();
;;;139                         }else if(page_sw == face_graph){
;;;140                             ResetG();
;;;141                         }else if(page_sw == face_set){
;;;142                             ResetSET();
;;;143                         }
;;;144    //                     resdone = 1;
;;;145    //                     resetflag = 0;
;;;146                         resetcount = 0;
;;;147                     }else{
;;;148                         resetcount++;
00003a  88b0              LDRH     r0,[r6,#4]  ; resetcount
00003c  1c40              ADDS     r0,r0,#1
00003e  80b0              STRH     r0,[r6,#4]
                  |L4.64|
;;;149                     }                
;;;150                 }
;;;151             }
;;;152             if(page_sw == face_r)
000040  7828              LDRB     r0,[r5,#0]  ; page_sw
;;;153    		 {
;;;154    			 if(step == 1)
;;;155    			 {
;;;156    				if(powcount < 10000)
;;;157    				{
;;;158    					SET_Current_Laod = set_static_lc;
;;;159    					flag_Load_CC = 1;
;;;160    					GPIO_SetBits(GPIOC,GPIO_Pin_10);//CC
;;;161    					GPIO_ResetBits(GPIOA,GPIO_Pin_15);//Ö§Ø“ØºÕ˜On
;;;162    					static_lv = DISS_Voltage;
;;;163    					powcount++;																		
;;;164    				}else{
;;;165    					powcount = 0;
;;;166    					
;;;167    					IO_OFF();
;;;168    					step = 2;
;;;169    				}
;;;170    			 }else if(step == 2){
;;;171    				if(powcount < 10000)
;;;172    				{
;;;173    					SET_Voltage = set_static_pv;
;;;174    					SET_Current = set_static_pc;
;;;175    					GPIO_SetBits(GPIOA,GPIO_Pin_15);//Ö§Ø“ØºÕ˜OFF
;;;176    					GPIO_ResetBits(GPIOC,GPIO_Pin_13);//Õ²ßªÖ§Ô´Ë¤Ô¶ÝŒÖ§Ç·
;;;177    					GPIO_SetBits(GPIOC,GPIO_Pin_1);//Õ²ßªÖ§Ô´Ë¤Ô¶
;;;178    					powcount++;
;;;179    					static_pc = DISS_POW_Current;
;;;180    				}else{
;;;181    					GPIO_ResetBits(GPIOC,GPIO_Pin_1);//¹Ø±ÕµçÔ´Êä³ö
;;;182    					Delay_ms(500);
;;;183    				    //GPIO_SetBits(GPIOC,GPIO_Pin_13);//¹Ø±ÕµçÔ´Êä³ö¼ÌµçÆ÷				
;;;184    					powcount = 0;
;;;185    					step = 3;
;;;186    //					IO_OFF();		
;;;187    					
;;;188    				}
;;;189    			 }else if(step == 3){
;;;190    				if(powcount < 5000)
;;;191    				{
;;;192    					powcount++;
;;;193    				}else{
;;;194    					
;;;195    					powcount = 0;	
;;;196    					sendload = 200;				
;;;197    					SET_Current_Laod = set_init_c;
;;;198    					GPIO_ResetBits(GPIOA,GPIO_Pin_15);//æ‰“å¼€è´Ÿè½½
;;;199    					step = 4;
;;;200    				}
;;;201    			 }else if(step == 4){
;;;202    				OC_CHECK();
;;;203    				stepcount ++;
;;;204    				if(stepcount == steptime*10)
;;;205    				{
;;;206    					OC_ADD();
;;;207    					stepcount = 0;
;;;208    				}
;;;209    			 }else if(step == 5){
;;;210    				if(powcount < 2000)
;;;211    				{
;;;212    					SET_Voltage = (int)v*100+200;
;;;213    					SET_Current = 1000;
;;;214    					GPIO_SetBits(GPIOA,GPIO_Pin_15);//Ö§Ø“ØºÕ˜OFF
;;;215    					GPIO_ResetBits(GPIOC,GPIO_Pin_13);//Õ²ßªÖ§Ô´Ë¤Ô¶ÝŒÖ§Ç·
;;;216    					GPIO_SetBits(GPIOC,GPIO_Pin_1);//Õ²ßªÖ§Ô´Ë¤Ô¶
;;;217    					powcount++;
;;;218    				}else{
;;;219    					GPIO_ResetBits(GPIOC,GPIO_Pin_1);//¹Ø±ÕµçÔ´Êä³ö
;;;220    					Delay_ms(500);
;;;221    				    //GPIO_SetBits(GPIOC,GPIO_Pin_13);//¹Ø±ÕµçÔ´Êä³ö¼ÌµçÆ÷				
;;;222    					powcount = 0;
;;;223    					step = 6;
;;;224    //					IO_OFF();
;;;225    				}
;;;226    			 }else if(step == 6){
;;;227    				if(flag_Load_CC == 1)
;;;228    				{
;;;229    					SET_Current_Laod = (int)(oc_data*1000)+8000; 
;;;230    					flag_Load_CC = 1;                              
;;;231    					GPIO_SetBits(GPIOC,GPIO_Pin_10);//CC
;;;232    					GPIO_ResetBits(GPIOA,GPIO_Pin_15);//Ö§Ø“ØºÕ˜On
;;;233    				}else if(flag_Load_CC == 0){
;;;234    					SET_Voltage_Laod = 0;
;;;235    					GPIO_SetBits(GPIOC,GPIO_Pin_10);//CV
;;;236    					flag_Load_CC = 0;
;;;237    					GPIO_ResetBits(GPIOA,GPIO_Pin_15);//Ö§Ø“ØºÕ˜On
;;;238    				}
;;;239    				if(((v - DISS_Voltage) > v*0.6)/* || (DISS_Current < 0.05)*/)
000042  ed9f9bf3          VLDR     d9,|L4.1040|
;;;240    				{
;;;241    					IO_OFF();
;;;242    					step = 7;
;;;243    				}else{
;;;244    					short_time++;                
000046  f8dfb3d0          LDR      r11,|L4.1048|
00004a  ed9faaf4          VLDR     s20,|L4.1052|
00004e  f8df83d0          LDR      r8,|L4.1056|
000052  4df4              LDR      r5,|L4.1060|
000054  4ff4              LDR      r7,|L4.1064|
000056  f44f797a          MOV      r9,#0x3e8             ;213
00005a  2803              CMP      r0,#3                 ;152
00005c  d029              BEQ      |L4.178|
00005e  e191              B        |L4.900|
                  |L4.96|
000060  f7fffffe          BL       sLCD_Init
000064  f7fffffe          BL       GUI_Init
000068  7828              LDRB     r0,[r5,#0]            ;130  ; page_sw
00006a  2802              CMP      r0,#2                 ;130
00006c  d00e              BEQ      |L4.140|
00006e  7828              LDRB     r0,[r5,#0]            ;133  ; page_sw
000070  2801              CMP      r0,#1                 ;133
000072  d00e              BEQ      |L4.146|
000074  7828              LDRB     r0,[r5,#0]            ;135  ; page_sw
000076  2803              CMP      r0,#3                 ;135
000078  d00e              BEQ      |L4.152|
00007a  7828              LDRB     r0,[r5,#0]            ;137  ; page_sw
00007c  2804              CMP      r0,#4                 ;137
00007e  d00e              BEQ      |L4.158|
000080  7828              LDRB     r0,[r5,#0]            ;139  ; page_sw
000082  b178              CBZ      r0,|L4.164|
000084  7828              LDRB     r0,[r5,#0]            ;141  ; page_sw
000086  2805              CMP      r0,#5                 ;141
000088  d00f              BEQ      |L4.170|
00008a  e010              B        |L4.174|
                  |L4.140|
00008c  f7fffffe          BL       ResetPow
000090  e00d              B        |L4.174|
                  |L4.146|
000092  f7fffffe          BL       ResetCDC
000096  e00a              B        |L4.174|
                  |L4.152|
000098  f7fffffe          BL       ResetR
00009c  e007              B        |L4.174|
                  |L4.158|
00009e  f7fffffe          BL       ResetLoad
0000a2  e004              B        |L4.174|
                  |L4.164|
0000a4  f7fffffe          BL       ResetG
0000a8  e001              B        |L4.174|
                  |L4.170|
0000aa  f7fffffe          BL       ResetSET
                  |L4.174|
0000ae  80b4              STRH     r4,[r6,#4]            ;146
0000b0  e7c6              B        |L4.64|
                  |L4.178|
0000b2  f8dfa378          LDR      r10,|L4.1068|
0000b6  f89a1000          LDRB     r1,[r10,#0]           ;154  ; step
0000ba  f2427010          MOV      r0,#0x2710            ;156
0000be  2901              CMP      r1,#1                 ;154
0000c0  d01e              BEQ      |L4.256|
0000c2  f89a1000          LDRB     r1,[r10,#0]           ;170  ; step
0000c6  2902              CMP      r1,#2                 ;170
0000c8  d041              BEQ      |L4.334|
0000ca  f89a1000          LDRB     r1,[r10,#0]           ;189  ; step
0000ce  20c8              MOVS     r0,#0xc8              ;196
0000d0  2903              CMP      r1,#3                 ;189
0000d2  d06a              BEQ      |L4.426|
0000d4  f89a1000          LDRB     r1,[r10,#0]           ;201  ; step
0000d8  2904              CMP      r1,#4                 ;201
0000da  d06f              BEQ      |L4.444|
0000dc  f89a1000          LDRB     r1,[r10,#0]           ;209  ; step
0000e0  2905              CMP      r1,#5                 ;209
0000e2  d06c              BEQ      |L4.446|
0000e4  f89a1000          LDRB     r1,[r10,#0]           ;226  ; step
0000e8  2906              CMP      r1,#6                 ;226
0000ea  d069              BEQ      |L4.448|
;;;245    				}
;;;246    			 }else if(step == 7){
0000ec  f89a1000          LDRB     r1,[r10,#0]  ; step
0000f0  2907              CMP      r1,#7
0000f2  d074              BEQ      |L4.478|
;;;247    				 if(powcount < 4000)
;;;248    				{
;;;249    					SET_Voltage =(int)v*100+200;
;;;250    					SET_Current = 1000;
;;;251    					GPIO_ResetBits(GPIOC,GPIO_Pin_13);//Õ²ßªÖ§Ô´Ë¤Ô¶ÝŒÖ§Ç·
;;;252    					GPIO_SetBits(GPIOC,GPIO_Pin_1);//Õ²ßªÖ§Ô´Ë¤Ô¶
;;;253    					powcount++;
;;;254    	//                 shortv = DISS_Voltage;
;;;255    				}else{
;;;256    					GPIO_ResetBits(GPIOC,GPIO_Pin_1);//¹Ø±ÕµçÔ´Êä³ö
;;;257    					Delay_ms(500);
;;;258    				    //GPIO_SetBits(GPIOC,GPIO_Pin_13);//¹Ø±ÕµçÔ´Êä³ö¼ÌµçÆ
;;;259    					powcount = 0;
;;;260    					step = 0;
;;;261    //					IO_OFF();                
;;;262    				}
;;;263    			 }else if(step == 0)
0000f4  f89a0000          LDRB     r0,[r10,#0]  ; step
0000f8  2800              CMP      r0,#0
0000fa  d071              BEQ      |L4.480|
0000fc  e142              B        |L4.900|
                  |L4.254|
0000fe  e297              B        |L4.1584|
                  |L4.256|
000100  8931              LDRH     r1,[r6,#8]            ;156  ; powcount
000102  4281              CMP      r1,r0                 ;156
000104  d21c              BCS      |L4.320|
000106  f8d500b0          LDR      r0,[r5,#0xb0]         ;158  ; Run_Control
00010a  6128              STR      r0,[r5,#0x10]         ;158  ; Run_Control
00010c  f8d80000          LDR      r0,[r8,#0]            ;159  ; flagD
000110  f0400080          ORR      r0,r0,#0x80           ;159
000114  f8c80000          STR      r0,[r8,#0]            ;159  ; flagD
000118  f44f6180          MOV      r1,#0x400             ;160
00011c  4638              MOV      r0,r7                 ;160
00011e  f7fffffe          BL       GPIO_SetBits
000122  f44f4100          MOV      r1,#0x8000            ;161
000126  48c2              LDR      r0,|L4.1072|
000128  f7fffffe          BL       GPIO_ResetBits
00012c  48c1              LDR      r0,|L4.1076|
00012e  ed900a00          VLDR     s0,[r0,#0]            ;162
000132  48c1              LDR      r0,|L4.1080|
000134  ed800a00          VSTR     s0,[r0,#0]            ;162
000138  8930              LDRH     r0,[r6,#8]            ;163  ; powcount
00013a  1c40              ADDS     r0,r0,#1              ;163
00013c  8130              STRH     r0,[r6,#8]            ;163
00013e  e121              B        |L4.900|
                  |L4.320|
000140  8134              STRH     r4,[r6,#8]            ;165
000142  f7fffffe          BL       IO_OFF
000146  2002              MOVS     r0,#2                 ;168
000148  f88a0000          STRB     r0,[r10,#0]           ;168
00014c  e11a              B        |L4.900|
                  |L4.334|
00014e  8931              LDRH     r1,[r6,#8]            ;171  ; powcount
000150  4281              CMP      r1,r0                 ;171
000152  d21d              BCS      |L4.400|
000154  f8d500a8          LDR      r0,[r5,#0xa8]         ;173  ; Run_Control
000158  6068              STR      r0,[r5,#4]            ;173  ; Run_Control
00015a  f8d500ac          LDR      r0,[r5,#0xac]         ;174  ; Run_Control
00015e  60a8              STR      r0,[r5,#8]            ;174  ; Run_Control
000160  f44f4100          MOV      r1,#0x8000            ;175
000164  48b2              LDR      r0,|L4.1072|
000166  f7fffffe          BL       GPIO_SetBits
00016a  f44f5100          MOV      r1,#0x2000            ;176
00016e  4638              MOV      r0,r7                 ;176
000170  f7fffffe          BL       GPIO_ResetBits
000174  2102              MOVS     r1,#2                 ;177
000176  4638              MOV      r0,r7                 ;177
000178  f7fffffe          BL       GPIO_SetBits
00017c  8930              LDRH     r0,[r6,#8]            ;178  ; powcount
00017e  1c40              ADDS     r0,r0,#1              ;178
000180  8130              STRH     r0,[r6,#8]            ;178
000182  48ae              LDR      r0,|L4.1084|
000184  ed900a00          VLDR     s0,[r0,#0]            ;179
000188  48ad              LDR      r0,|L4.1088|
00018a  ed800a00          VSTR     s0,[r0,#0]            ;179
00018e  e0f9              B        |L4.900|
                  |L4.400|
000190  2102              MOVS     r1,#2                 ;181
000192  4638              MOV      r0,r7                 ;181
000194  f7fffffe          BL       GPIO_ResetBits
000198  f44f70fa          MOV      r0,#0x1f4             ;182
00019c  f7fffffe          BL       Delay_ms
0001a0  8134              STRH     r4,[r6,#8]            ;184
0001a2  2003              MOVS     r0,#3                 ;185
0001a4  f88a0000          STRB     r0,[r10,#0]           ;185
0001a8  e0ec              B        |L4.900|
                  |L4.426|
0001aa  8932              LDRH     r2,[r6,#8]            ;190  ; powcount
0001ac  f2413188          MOV      r1,#0x1388            ;190
0001b0  428a              CMP      r2,r1                 ;190
0001b2  d206              BCS      |L4.450|
0001b4  8930              LDRH     r0,[r6,#8]            ;192  ; powcount
0001b6  1c40              ADDS     r0,r0,#1              ;192
0001b8  8130              STRH     r0,[r6,#8]            ;192
0001ba  e0e3              B        |L4.900|
                  |L4.444|
0001bc  e011              B        |L4.482|
                  |L4.446|
0001be  e027              B        |L4.528|
                  |L4.448|
0001c0  e059              B        |L4.630|
                  |L4.450|
0001c2  8134              STRH     r4,[r6,#8]            ;195
0001c4  499f              LDR      r1,|L4.1092|
0001c6  8008              STRH     r0,[r1,#0]            ;196
0001c8  6da8              LDR      r0,[r5,#0x58]         ;197  ; Run_Control
0001ca  6128              STR      r0,[r5,#0x10]         ;197  ; Run_Control
0001cc  f44f4100          MOV      r1,#0x8000            ;198
0001d0  4897              LDR      r0,|L4.1072|
0001d2  f7fffffe          BL       GPIO_ResetBits
0001d6  2004              MOVS     r0,#4                 ;199
0001d8  f88a0000          STRB     r0,[r10,#0]           ;199
0001dc  e0d2              B        |L4.900|
                  |L4.478|
0001de  e0a1              B        |L4.804|
                  |L4.480|
0001e0  e0cd              B        |L4.894|
                  |L4.482|
0001e2  f7fffffe          BL       OC_CHECK
0001e6  f8dfa260          LDR      r10,|L4.1096|
0001ea  f8ba0000          LDRH     r0,[r10,#0]           ;203  ; stepcount
0001ee  1c40              ADDS     r0,r0,#1              ;203
0001f0  f8aa0000          STRH     r0,[r10,#0]           ;203
0001f4  4895              LDR      r0,|L4.1100|
0001f6  8800              LDRH     r0,[r0,#0]            ;204  ; steptime
0001f8  f8ba1000          LDRH     r1,[r10,#0]           ;204  ; stepcount
0001fc  eb000080          ADD      r0,r0,r0,LSL #2       ;204
000200  ebb10f40          CMP      r1,r0,LSL #1          ;204
000204  d103              BNE      |L4.526|
000206  f7fffffe          BL       OC_ADD
00020a  f8aa4000          STRH     r4,[r10,#0]           ;207
                  |L4.526|
00020e  e0b9              B        |L4.900|
                  |L4.528|
000210  8931              LDRH     r1,[r6,#8]            ;210  ; powcount
000212  f5b16ffa          CMP      r1,#0x7d0             ;210
000216  d221              BCS      |L4.604|
000218  498d              LDR      r1,|L4.1104|
00021a  ed910a00          VLDR     s0,[r1,#0]            ;212
00021e  eebd0ac0          VCVT.S32.F32 s0,s0                 ;212
000222  ee101a10          VMOV     r1,s0                 ;212
000226  eb0102c1          ADD      r2,r1,r1,LSL #3       ;212
00022a  eb021101          ADD      r1,r2,r1,LSL #4       ;212
00022e  eb000081          ADD      r0,r0,r1,LSL #2       ;212
000232  6068              STR      r0,[r5,#4]            ;212  ; Run_Control
000234  f8c59008          STR      r9,[r5,#8]            ;213  ; Run_Control
000238  f44f4100          MOV      r1,#0x8000            ;214
00023c  487c              LDR      r0,|L4.1072|
00023e  f7fffffe          BL       GPIO_SetBits
000242  f44f5100          MOV      r1,#0x2000            ;215
000246  4638              MOV      r0,r7                 ;215
000248  f7fffffe          BL       GPIO_ResetBits
00024c  2102              MOVS     r1,#2                 ;216
00024e  4638              MOV      r0,r7                 ;216
000250  f7fffffe          BL       GPIO_SetBits
000254  8930              LDRH     r0,[r6,#8]            ;217  ; powcount
000256  1c40              ADDS     r0,r0,#1              ;217
000258  8130              STRH     r0,[r6,#8]            ;217
00025a  e093              B        |L4.900|
                  |L4.604|
00025c  2102              MOVS     r1,#2                 ;219
00025e  4638              MOV      r0,r7                 ;219
000260  f7fffffe          BL       GPIO_ResetBits
000264  f44f70fa          MOV      r0,#0x1f4             ;220
000268  f7fffffe          BL       Delay_ms
00026c  8134              STRH     r4,[r6,#8]            ;222
00026e  2006              MOVS     r0,#6                 ;223
000270  f88a0000          STRB     r0,[r10,#0]           ;223
000274  e086              B        |L4.900|
                  |L4.630|
000276  f8d80000          LDR      r0,[r8,#0]            ;227  ; flagD
00027a  0601              LSLS     r1,r0,#24             ;227
00027c  d51a              BPL      |L4.692|
00027e  4975              LDR      r1,|L4.1108|
000280  ed910a00          VLDR     s0,[r1,#0]            ;229
000284  ee200a0a          VMUL.F32 s0,s0,s20             ;229
000288  eebd0ac0          VCVT.S32.F32 s0,s0                 ;229
00028c  ee101a10          VMOV     r1,s0                 ;229
000290  f50151fa          ADD      r1,r1,#0x1f40         ;229
000294  6129              STR      r1,[r5,#0x10]         ;229  ; Run_Control
000296  f0400080          ORR      r0,r0,#0x80           ;230
00029a  f8c80000          STR      r0,[r8,#0]            ;230  ; flagD
00029e  f44f6180          MOV      r1,#0x400             ;231
0002a2  4638              MOV      r0,r7                 ;231
0002a4  f7fffffe          BL       GPIO_SetBits
0002a8  f44f4100          MOV      r1,#0x8000            ;232
0002ac  4860              LDR      r0,|L4.1072|
0002ae  f7fffffe          BL       GPIO_ResetBits
0002b2  e010              B        |L4.726|
                  |L4.692|
0002b4  60ec              STR      r4,[r5,#0xc]          ;234  ; Run_Control
0002b6  f44f6180          MOV      r1,#0x400             ;235
0002ba  4638              MOV      r0,r7                 ;235
0002bc  f7fffffe          BL       GPIO_SetBits
0002c0  f8d80000          LDR      r0,[r8,#0]            ;236  ; flagD
0002c4  f0200080          BIC      r0,r0,#0x80           ;236
0002c8  f8c80000          STR      r0,[r8,#0]            ;236  ; flagD
0002cc  f44f4100          MOV      r1,#0x8000            ;237
0002d0  4857              LDR      r0,|L4.1072|
0002d2  f7fffffe          BL       GPIO_ResetBits
                  |L4.726|
0002d6  485e              LDR      r0,|L4.1104|
0002d8  edd0aa00          VLDR     s21,[r0,#0]           ;239
0002dc  ee1a0a90          VMOV     r0,s21                ;239
0002e0  f7fffffe          BL       __aeabi_f2d
0002e4  ec532b19          VMOV     r2,r3,d9              ;239
0002e8  f7fffffe          BL       __aeabi_dmul
0002ec  ec410b18          VMOV     d8,r0,r1              ;239
0002f0  4850              LDR      r0,|L4.1076|
0002f2  ed900a00          VLDR     s0,[r0,#0]            ;239
0002f6  ee3a0ac0          VSUB.F32 s0,s21,s0             ;239
0002fa  ee100a10          VMOV     r0,s0                 ;239
0002fe  f7fffffe          BL       __aeabi_f2d
000302  ec532b18          VMOV     r2,r3,d8              ;239
000306  f7fffffe          BL       __aeabi_cdrcmple
00030a  d205              BCS      |L4.792|
00030c  f7fffffe          BL       IO_OFF
000310  2007              MOVS     r0,#7                 ;242
000312  f88a0000          STRB     r0,[r10,#0]           ;242
000316  e035              B        |L4.900|
                  |L4.792|
000318  f8bb0000          LDRH     r0,[r11,#0]           ;244  ; short_time
00031c  1c40              ADDS     r0,r0,#1              ;244
00031e  f8ab0000          STRH     r0,[r11,#0]           ;244
000322  e02f              B        |L4.900|
                  |L4.804|
000324  8931              LDRH     r1,[r6,#8]            ;247  ; powcount
000326  f5b16f7a          CMP      r1,#0xfa0             ;247
00032a  d21c              BCS      |L4.870|
00032c  4948              LDR      r1,|L4.1104|
00032e  ed910a00          VLDR     s0,[r1,#0]            ;249
000332  eebd0ac0          VCVT.S32.F32 s0,s0                 ;249
000336  ee101a10          VMOV     r1,s0                 ;249
00033a  eb0102c1          ADD      r2,r1,r1,LSL #3       ;249
00033e  eb021101          ADD      r1,r2,r1,LSL #4       ;249
000342  eb000081          ADD      r0,r0,r1,LSL #2       ;249
000346  6068              STR      r0,[r5,#4]            ;249  ; Run_Control
000348  f8c59008          STR      r9,[r5,#8]            ;250  ; Run_Control
00034c  f44f5100          MOV      r1,#0x2000            ;251
000350  4638              MOV      r0,r7                 ;251
000352  f7fffffe          BL       GPIO_ResetBits
000356  2102              MOVS     r1,#2                 ;252
000358  4638              MOV      r0,r7                 ;252
00035a  f7fffffe          BL       GPIO_SetBits
00035e  8930              LDRH     r0,[r6,#8]            ;253  ; powcount
000360  1c40              ADDS     r0,r0,#1              ;253
000362  8130              STRH     r0,[r6,#8]            ;253
000364  e00e              B        |L4.900|
                  |L4.870|
000366  2102              MOVS     r1,#2                 ;256
000368  4638              MOV      r0,r7                 ;256
00036a  f7fffffe          BL       GPIO_ResetBits
00036e  f44f70fa          MOV      r0,#0x1f4             ;257
000372  f7fffffe          BL       Delay_ms
000376  8134              STRH     r4,[r6,#8]            ;259
000378  f88a4000          STRB     r4,[r10,#0]           ;260
00037c  e002              B        |L4.900|
                  |L4.894|
;;;264    			 {
;;;265    				 powcount = 0;
00037e  8134              STRH     r4,[r6,#8]
;;;266    				 IO_OFF();
000380  f7fffffe          BL       IO_OFF
                  |L4.900|
;;;267    			 }
;;;268    		}
;;;269            
;;;270    		
;;;271            if(usartocflag == 1)
000384  7830              LDRB     r0,[r6,#0]  ; usartocflag
000386  f04f0a01          MOV      r10,#1                ;116
00038a  2801              CMP      r0,#1
00038c  d168              BNE      |L4.1120|
;;;272            {
;;;273    
;;;274                if(flag_Load_CC == 1)
00038e  f8980000          LDRB     r0,[r8,#0]  ; flagD
000392  0600              LSLS     r0,r0,#24
000394  d510              BPL      |L4.952|
;;;275                {   
;;;276    //				load_sw = load_on;
;;;277                    GPIO_SetBits(GPIOC,GPIO_Pin_10);//CC
000396  f44f6180          MOV      r1,#0x400
00039a  4638              MOV      r0,r7
00039c  f7fffffe          BL       GPIO_SetBits
;;;278    				flag_Load_CC = 1;
0003a0  f8d80000          LDR      r0,[r8,#0]  ; flagD
0003a4  f0400080          ORR      r0,r0,#0x80
0003a8  f8c80000          STR      r0,[r8,#0]  ; flagD
;;;279                    GPIO_ResetBits(GPIOA,GPIO_Pin_15);//µç×Ó¸ºÔØOn
0003ac  f44f4100          MOV      r1,#0x8000
0003b0  481f              LDR      r0,|L4.1072|
0003b2  f7fffffe          BL       GPIO_ResetBits
0003b6  e010              B        |L4.986|
                  |L4.952|
;;;280                }else if(flag_Load_CC == 0){
;;;281                    SET_Voltage_Laod = 0;
0003b8  60ec              STR      r4,[r5,#0xc]  ; Run_Control
;;;282                    GPIO_ResetBits(GPIOC,GPIO_Pin_10);//CV
0003ba  f44f6180          MOV      r1,#0x400
0003be  4638              MOV      r0,r7
0003c0  f7fffffe          BL       GPIO_ResetBits
;;;283                    flag_Load_CC = 0;
0003c4  f8d80000          LDR      r0,[r8,#0]  ; flagD
0003c8  f0200080          BIC      r0,r0,#0x80
0003cc  f8c80000          STR      r0,[r8,#0]  ; flagD
;;;284                    GPIO_ResetBits(GPIOA,GPIO_Pin_15);//µç×Ó¸ºÔØOn
0003d0  f44f4100          MOV      r1,#0x8000
0003d4  4816              LDR      r0,|L4.1072|
0003d6  f7fffffe          BL       GPIO_ResetBits
                  |L4.986|
;;;285                }
;;;286                crec2 = crec1;
0003da  ed960a05          VLDR     s0,[r6,#0x14]
0003de  ed860a06          VSTR     s0,[r6,#0x18]
;;;287                crec1 = DISS_Current;
0003e2  481d              LDR      r0,|L4.1112|
0003e4  edd00a00          VLDR     s1,[r0,#0]
0003e8  edc60a05          VSTR     s1,[r6,#0x14]
;;;288                if(crec1 < crec2 && crec2 > 0.3)
0003ec  eef40ac0          VCMPE.F32 s1,s0
0003f0  eef1fa10          VMRS     APSR_nzcv,FPSCR
0003f4  d256              BCS      |L4.1188|
0003f6  ee100a10          VMOV     r0,s0
0003fa  4918              LDR      r1,|L4.1116|
0003fc  4288              CMP      r0,r1
0003fe  db51              BLT      |L4.1188|
;;;289                {     
;;;290                    oc_data = crec2;
000400  4814              LDR      r0,|L4.1108|
000402  e02e              B        |L4.1122|
                  |L4.1028|
                          DCD      0x40000800
                  |L4.1032|
                          DCD      page_sw
                  |L4.1036|
                          DCD      ||.data||
                  |L4.1040|
000410  33333333          DCFD     0x3fe3333333333333 ; 0.59999999999999998
000414  3fe33333
                  |L4.1048|
                          DCD      short_time
                  |L4.1052|
00041c  447a0000          DCFS     0x447a0000 ; 1000
                  |L4.1056|
                          DCD      flagD
                  |L4.1060|
                          DCD      Run_Control
                  |L4.1064|
                          DCD      0x40020800
                  |L4.1068|
                          DCD      step
                  |L4.1072|
                          DCD      0x40020000
                  |L4.1076|
                          DCD      DISS_Voltage
                  |L4.1080|
                          DCD      static_lv
                  |L4.1084|
                          DCD      DISS_POW_Current
                  |L4.1088|
                          DCD      static_pc
                  |L4.1092|
                          DCD      sendload
                  |L4.1096|
                          DCD      stepcount
                  |L4.1100|
                          DCD      steptime
                  |L4.1104|
                          DCD      v
                  |L4.1108|
                          DCD      oc_data
                  |L4.1112|
                          DCD      DISS_Current
                  |L4.1116|
                          DCD      0x3e99999a
                  |L4.1120|
000460  e02a              B        |L4.1208|
                  |L4.1122|
000462  ed800a00          VSTR     s0,[r0,#0]
;;;291                    g_tModS.TxBuf[13] = (int)(oc_data*1000)>>8;
000466  ee200a0a          VMUL.F32 s0,s0,s20
00046a  4978              LDR      r1,|L4.1612|
00046c  eebd0ac0          VCVT.S32.F32 s0,s0
000470  ee100a10          VMOV     r0,s0
000474  0a00              LSRS     r0,r0,#8
000476  7008              STRB     r0,[r1,#0]
;;;292                    g_tModS.TxBuf[14] = (int)(oc_data*1000);
000478  ee100a10          VMOV     r0,s0
00047c  7048              STRB     r0,[r1,#1]
;;;293                    SET_Current_Laod = set_init_c;
00047e  6da8              LDR      r0,[r5,#0x58]  ; Run_Control
000480  6128              STR      r0,[r5,#0x10]  ; Run_Control
;;;294                    GPIO_SetBits(GPIOA,GPIO_Pin_15);//å…³é—­è´Ÿè½½ 
000482  f44f4100          MOV      r1,#0x8000
000486  4872              LDR      r0,|L4.1616|
000488  f7fffffe          BL       GPIO_SetBits
;;;295    //                MODS_SendWithCRC(g_tModS.TxBuf, g_tModS.TxCount);
;;;296                    t_onoff = 0;
00048c  4871              LDR      r0,|L4.1620|
00048e  7004              STRB     r4,[r0,#0]
;;;297                    usartocflag = 0;
000490  7034              STRB     r4,[r6,#0]
;;;298                    crec1 = 0;
000492  ed9f0a71          VLDR     s0,|L4.1624|
000496  ed860a05          VSTR     s0,[r6,#0x14]
;;;299                    crec2 = 0;
00049a  ed860a06          VSTR     s0,[r6,#0x18]
;;;300                    powflag = 1;
00049e  f8a6a00a          STRH     r10,[r6,#0xa]
0004a2  e009              B        |L4.1208|
                  |L4.1188|
;;;301                    
;;;302                }else{
;;;303                    if(flag_Load_CC == 1)
0004a4  f8980000          LDRB     r0,[r8,#0]  ; flagD
0004a8  0600              LSLS     r0,r0,#24
0004aa  d505              BPL      |L4.1208|
;;;304                    {
;;;305                        if(uocount == 20)
0004ac  88f0              LDRH     r0,[r6,#6]  ; uocount
0004ae  2814              CMP      r0,#0x14
0004b0  d006              BEQ      |L4.1216|
;;;306                        {
;;;307                            SET_Current_Laod = SET_Current_Laod + 10;
;;;308                            uocount = 0;
;;;309                        }else{
;;;310                            uocount++;
0004b2  88f0              LDRH     r0,[r6,#6]  ; uocount
0004b4  1c40              ADDS     r0,r0,#1
0004b6  80f0              STRH     r0,[r6,#6]
                  |L4.1208|
;;;311                        }
;;;312                    }                    
;;;313                }
;;;314            }
;;;315            if(powflag == 1)
0004b8  8970              LDRH     r0,[r6,#0xa]  ; powflag
0004ba  2801              CMP      r0,#1
0004bc  d005              BEQ      |L4.1226|
0004be  e026              B        |L4.1294|
                  |L4.1216|
0004c0  6928              LDR      r0,[r5,#0x10]         ;307  ; Run_Control
0004c2  300a              ADDS     r0,r0,#0xa            ;307
0004c4  6128              STR      r0,[r5,#0x10]         ;307  ; Run_Control
0004c6  80f4              STRH     r4,[r6,#6]            ;308
0004c8  e7f6              B        |L4.1208|
                  |L4.1226|
;;;316            {
;;;317                if(powcount < 1000)
0004ca  8930              LDRH     r0,[r6,#8]  ; powcount
0004cc  4548              CMP      r0,r9
0004ce  d216              BCS      |L4.1278|
;;;318                {
;;;319                    SET_Voltage =3000;
0004d0  f64030b8          MOV      r0,#0xbb8
0004d4  6068              STR      r0,[r5,#4]  ; Run_Control
;;;320                    SET_Current = 1000;
0004d6  f8c59008          STR      r9,[r5,#8]  ; Run_Control
;;;321                    GPIO_SetBits(GPIOA,GPIO_Pin_15);//µç×Ó¸ºÔØOFF
0004da  f44f4100          MOV      r1,#0x8000
0004de  485c              LDR      r0,|L4.1616|
0004e0  f7fffffe          BL       GPIO_SetBits
;;;322                    GPIO_ResetBits(GPIOC,GPIO_Pin_13);//´ò¿ªµçÔ´Êä³ö¼ÌµçÆ÷
0004e4  f44f5100          MOV      r1,#0x2000
0004e8  4638              MOV      r0,r7
0004ea  f7fffffe          BL       GPIO_ResetBits
;;;323                    GPIO_SetBits(GPIOC,GPIO_Pin_1);//´ò¿ªµçÔ´Êä³ö
0004ee  2102              MOVS     r1,#2
0004f0  4638              MOV      r0,r7
0004f2  f7fffffe          BL       GPIO_SetBits
;;;324                    powcount++;
0004f6  8930              LDRH     r0,[r6,#8]  ; powcount
0004f8  1c40              ADDS     r0,r0,#1
0004fa  8130              STRH     r0,[r6,#8]
0004fc  e007              B        |L4.1294|
                  |L4.1278|
;;;325    //                 shortv = DISS_Voltage;
;;;326                }else{
;;;327                    powcount = 0;
0004fe  8134              STRH     r4,[r6,#8]
;;;328                    powflag = 0;
000500  8174              STRH     r4,[r6,#0xa]
;;;329                    GPIO_ResetBits(GPIOC,GPIO_Pin_1);//¹Ø±ÕµçÔ´Êä³ö
000502  2102              MOVS     r1,#2
000504  4638              MOV      r0,r7
000506  f7fffffe          BL       GPIO_ResetBits
;;;330                    //GPIO_SetBits(GPIOC,GPIO_Pin_13);//¹Ø±ÕµçÔ´Êä³ö¼ÌµçÆ÷ 
;;;331                    usartshortflag = 1;
00050a  f886a001          STRB     r10,[r6,#1]
                  |L4.1294|
;;;332                    
;;;333                }
;;;334            }
;;;335            if(usartshortflag == 1)
00050e  7870              LDRB     r0,[r6,#1]  ; usartshortflag
000510  2801              CMP      r0,#1
000512  d176              BNE      |L4.1538|
;;;336            {
;;;337                if(flag_Load_CC == 1)
000514  f8980000          LDRB     r0,[r8,#0]  ; flagD
000518  0600              LSLS     r0,r0,#24
00051a  d522              BPL      |L4.1378|
;;;338                {
;;;339                    SET_Current_Laod = (int)(oc_data*1000)+5000; 
00051c  484f              LDR      r0,|L4.1628|
00051e  f2413188          MOV      r1,#0x1388
000522  ed900a00          VLDR     s0,[r0,#0]
000526  ee200a0a          VMUL.F32 s0,s0,s20
00052a  eebd0ac0          VCVT.S32.F32 s0,s0
00052e  ee100a10          VMOV     r0,s0
000532  4408              ADD      r0,r0,r1
000534  6128              STR      r0,[r5,#0x10]  ; Run_Control
;;;340                    GPIO_SetBits(GPIOC,GPIO_Pin_10);//CC
000536  f44f6180          MOV      r1,#0x400
00053a  4638              MOV      r0,r7
00053c  f7fffffe          BL       GPIO_SetBits
;;;341                    flag_Load_CC = 1;                              
000540  f8d80000          LDR      r0,[r8,#0]  ; flagD
000544  f0400080          ORR      r0,r0,#0x80
000548  f8c80000          STR      r0,[r8,#0]  ; flagD
;;;342                    GPIO_SetBits(GPIOC,GPIO_Pin_10);//CC
00054c  f44f6180          MOV      r1,#0x400
000550  4638              MOV      r0,r7
000552  f7fffffe          BL       GPIO_SetBits
;;;343                    GPIO_ResetBits(GPIOA,GPIO_Pin_15);//µç×Ó¸ºÔØOn
000556  f44f4100          MOV      r1,#0x8000
00055a  483d              LDR      r0,|L4.1616|
00055c  f7fffffe          BL       GPIO_ResetBits
000560  e010              B        |L4.1412|
                  |L4.1378|
;;;344                }else if(flag_Load_CC == 0){
;;;345                    SET_Voltage_Laod = 0;
000562  60ec              STR      r4,[r5,#0xc]  ; Run_Control
;;;346                    GPIO_SetBits(GPIOC,GPIO_Pin_10);//CV
000564  f44f6180          MOV      r1,#0x400
000568  4638              MOV      r0,r7
00056a  f7fffffe          BL       GPIO_SetBits
;;;347                    flag_Load_CC = 0;
00056e  f8d80000          LDR      r0,[r8,#0]  ; flagD
000572  f0200080          BIC      r0,r0,#0x80
000576  f8c80000          STR      r0,[r8,#0]  ; flagD
;;;348                    GPIO_ResetBits(GPIOA,GPIO_Pin_15);//µç×Ó¸ºÔØOn
00057a  f44f4100          MOV      r1,#0x8000
00057e  4834              LDR      r0,|L4.1616|
000580  f7fffffe          BL       GPIO_ResetBits
                  |L4.1412|
;;;349                }
;;;350                if(((shortv - DISS_Voltage) > shortv*0.6) || (DISS_Current < 0.05))
000584  ed96aa09          VLDR     s20,[r6,#0x24]
000588  ee1a0a10          VMOV     r0,s20
00058c  f7fffffe          BL       __aeabi_f2d
000590  ec532b19          VMOV     r2,r3,d9
000594  f7fffffe          BL       __aeabi_dmul
000598  ec410b18          VMOV     d8,r0,r1
00059c  4830              LDR      r0,|L4.1632|
00059e  ed900a00          VLDR     s0,[r0,#0]
0005a2  ee3a0a40          VSUB.F32 s0,s20,s0
0005a6  ee100a10          VMOV     r0,s0
0005aa  f7fffffe          BL       __aeabi_f2d
0005ae  ec532b18          VMOV     r2,r3,d8
0005b2  f7fffffe          BL       __aeabi_cdrcmple
0005b6  d304              BCC      |L4.1474|
0005b8  482a              LDR      r0,|L4.1636|
0005ba  6800              LDR      r0,[r0,#0]  ; DISS_Current
0005bc  492a              LDR      r1,|L4.1640|
0005be  4288              CMP      r0,r1
0005c0  da1a              BGE      |L4.1528|
                  |L4.1474|
;;;351                {
;;;352                    IO_OFF();
0005c2  f7fffffe          BL       IO_OFF
;;;353                    usartshortflag = 0;               
0005c6  7074              STRB     r4,[r6,#1]
;;;354                    g_tModS.TxBuf[17] = (short_time/10)>>8;
0005c8  f8bb0000          LDRH     r0,[r11,#0]  ; short_time
0005cc  210a              MOVS     r1,#0xa
0005ce  fbb0f0f1          UDIV     r0,r0,r1
0005d2  0a02              LSRS     r2,r0,#8
0005d4  481d              LDR      r0,|L4.1612|
0005d6  1d00              ADDS     r0,r0,#4
0005d8  7002              STRB     r2,[r0,#0]
;;;355                    g_tModS.TxBuf[18] = (short_time/10);
0005da  f8bb2000          LDRH     r2,[r11,#0]  ; short_time
0005de  fbb2f1f1          UDIV     r1,r2,r1
0005e2  7041              STRB     r1,[r0,#1]
;;;356                    MODS_SendWithCRC(g_tModS.TxBuf, g_tModS.TxCount);
0005e4  f8901073          LDRB     r1,[r0,#0x73]  ; g_tModS
0005e8  3811              SUBS     r0,r0,#0x11
0005ea  f7fffffe          BL       MODS_SendWithCRC
;;;357                    finishflag=1;
0005ee  f8a6a00c          STRH     r10,[r6,#0xc]
;;;358                    short_time = 0;
0005f2  f8ab4000          STRH     r4,[r11,#0]
0005f6  e004              B        |L4.1538|
                  |L4.1528|
;;;359                }else{
;;;360                    short_time++;                
0005f8  f8bb0000          LDRH     r0,[r11,#0]  ; short_time
0005fc  1c40              ADDS     r0,r0,#1
0005fe  f8ab0000          STRH     r0,[r11,#0]
                  |L4.1538|
;;;361                }
;;;362            }
;;;363            if(finishflag == 1)
000602  89b0              LDRH     r0,[r6,#0xc]  ; finishflag
000604  2801              CMP      r0,#1
000606  d113              BNE      |L4.1584|
;;;364            {
;;;365                if(powcount < 1000)
000608  8930              LDRH     r0,[r6,#8]  ; powcount
00060a  4548              CMP      r0,r9
00060c  d214              BCS      |L4.1592|
;;;366                {
;;;367                    SET_Voltage =3000;
00060e  f64030b8          MOV      r0,#0xbb8
000612  6068              STR      r0,[r5,#4]  ; Run_Control
;;;368                    SET_Current = 1000;
000614  f8c59008          STR      r9,[r5,#8]  ; Run_Control
;;;369                    GPIO_ResetBits(GPIOC,GPIO_Pin_13);//´ò¿ªµçÔ´Êä³ö¼ÌµçÆ÷
000618  f44f5100          MOV      r1,#0x2000
00061c  4638              MOV      r0,r7
00061e  f7fffffe          BL       GPIO_ResetBits
;;;370                    GPIO_SetBits(GPIOC,GPIO_Pin_1);//´ò¿ªµçÔ´Êä³ö
000622  2102              MOVS     r1,#2
000624  4638              MOV      r0,r7
000626  f7fffffe          BL       GPIO_SetBits
;;;371                    powcount++;
00062a  8930              LDRH     r0,[r6,#8]  ; powcount
00062c  1c40              ADDS     r0,r0,#1
00062e  8130              STRH     r0,[r6,#8]
                  |L4.1584|
;;;372    //                 shortv = DISS_Voltage;
;;;373                }else{
;;;374                    SET_Current_Laod = 1000;
;;;375                    powcount = 0;
;;;376                    finishflag = 0;
;;;377                    IO_OFF();                
;;;378                }
;;;379            }
;;;380        }    
;;;381    }
000630  ecbd8b06          VPOP     {d8-d10}
000634  e8bd9ff0          POP      {r4-r12,pc}
                  |L4.1592|
000638  f8c59010          STR      r9,[r5,#0x10]         ;374  ; Run_Control
00063c  8134              STRH     r4,[r6,#8]            ;375
00063e  81b4              STRH     r4,[r6,#0xc]          ;376
000640  ecbd8b06          VPOP     {d8-d10}              ;377
000644  e8bd5ff0          POP      {r4-r12,lr}           ;377
000648  f7ffbffe          B.W      IO_OFF
;;;382    
                          ENDP

                  |L4.1612|
                          DCD      g_tModS+0x2b
                  |L4.1616|
                          DCD      0x40020000
                  |L4.1620|
                          DCD      t_onoff
                  |L4.1624|
000658  00000000          DCFS     0x00000000 ; 0
                  |L4.1628|
                          DCD      oc_data
                  |L4.1632|
                          DCD      DISS_Voltage
                  |L4.1636|
                          DCD      DISS_Current
                  |L4.1640|
                          DCD      0x3d4ccccd

                          AREA ||i.TIM4_Int_Init||, CODE, READONLY, ALIGN=2

                  TIM4_Int_Init PROC
;;;75     //?o???¡¦??? 3!
;;;76     void TIM4_Int_Init(u16 arr,u16 psc)
000000  b57f              PUSH     {r0-r6,lr}
;;;77     {
000002  4604              MOV      r4,r0
000004  460d              MOV      r5,r1
;;;78         TIM_TimeBaseInitTypeDef TIM_TimeBaseInitStructure;
;;;79         NVIC_InitTypeDef NVIC_InitStructure;
;;;80         
;;;81         RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM4,ENABLE); //¨´?? TIM3 ??
000006  2101              MOVS     r1,#1
000008  2004              MOVS     r0,#4
00000a  f7fffffe          BL       RCC_APB1PeriphClockCmd
;;;82         TIM_TimeBaseInitStructure.TIM_Period = arr; //??????
00000e  9402              STR      r4,[sp,#8]
;;;83         TIM_TimeBaseInitStructure.TIM_Prescaler=psc; //?????
000010  f8ad5004          STRH     r5,[sp,#4]
;;;84         TIM_TimeBaseInitStructure.TIM_CounterMode=TIM_CounterMode_Up; //§Ó?????
000014  2000              MOVS     r0,#0
000016  f8ad0006          STRH     r0,[sp,#6]
;;;85         TIM_TimeBaseInitStructure.TIM_ClockDivision=TIM_CKD_DIV1;
00001a  f8ad000c          STRH     r0,[sp,#0xc]
;;;86         TIM_TimeBaseInit(TIM4,&TIM_TimeBaseInitStructure);// ¨²?????? TIM3
00001e  4c0e              LDR      r4,|L5.88|
000020  a901              ADD      r1,sp,#4
000022  4620              MOV      r0,r4
000024  f7fffffe          BL       TIM_TimeBaseInit
;;;87         TIM_ITConfig(TIM4,TIM_IT_Update,ENABLE); //?????? 3 ?§ä??
000028  2201              MOVS     r2,#1
00002a  4611              MOV      r1,r2
00002c  4620              MOV      r0,r4
00002e  f7fffffe          BL       TIM_ITConfig
;;;88         NVIC_InitStructure.NVIC_IRQChannel=TIM4_IRQn; //??? 3 ??
000032  211e              MOVS     r1,#0x1e
000034  f88d1000          STRB     r1,[sp,#0]
;;;89         NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority=0x01; //????? 1
000038  2101              MOVS     r1,#1
00003a  f88d1001          STRB     r1,[sp,#1]
;;;90         NVIC_InitStructure.NVIC_IRQChannelSubPriority=0x03; //§¾???? 3
00003e  2203              MOVS     r2,#3
000040  f88d2002          STRB     r2,[sp,#2]
;;;91         NVIC_InitStructure.NVIC_IRQChannelCmd=ENABLE;
000044  f88d1003          STRB     r1,[sp,#3]
;;;92         NVIC_Init(&NVIC_InitStructure);// ¨¹??? NVIC
000048  4668              MOV      r0,sp
00004a  f7fffffe          BL       NVIC_Init
;;;93         TIM_Cmd(TIM4,ENABLE); //Y????? 3
00004e  2101              MOVS     r1,#1
000050  4620              MOV      r0,r4
000052  f7fffffe          BL       TIM_Cmd
;;;94     }
000056  bd7f              POP      {r0-r6,pc}
;;;95     //??? 3 ??????
                          ENDP

                  |L5.88|
                          DCD      0x40000800

                          AREA ||i.TIM5_IRQHandler||, CODE, READONLY, ALIGN=2

                  TIM5_IRQHandler PROC
;;;654    
;;;655    void TIM5_IRQHandler(void)
000000  b510              PUSH     {r4,lr}
;;;656    {
;;;657        
;;;658        if(TIM_GetITStatus(TIM5,TIM_IT_Update)==SET) //Ó§Ô¶××
000002  4c0a              LDR      r4,|L6.44|
000004  2101              MOVS     r1,#1
000006  4620              MOV      r0,r4
000008  f7fffffe          BL       TIM_GetITStatus
00000c  2801              CMP      r0,#1
00000e  d10b              BNE      |L6.40|
;;;659        {
;;;660            TIM_ClearITPendingBit(TIM5,TIM_IT_Update); //æ¸…é™¤ä¸­æ–­æ ‡å¿—ä½?
000010  2101              MOVS     r1,#1
000012  4620              MOV      r0,r4
000014  f7fffffe          BL       TIM_ClearITPendingBit
;;;661            Tick_10ms ++;
000018  4805              LDR      r0,|L6.48|
00001a  6901              LDR      r1,[r0,#0x10]  ; Tick_10ms
00001c  1c49              ADDS     r1,r1,#1
00001e  6101              STR      r1,[r0,#0x10]  ; Tick_10ms
;;;662            MODS_Poll();
000020  e8bd4010          POP      {r4,lr}
000024  f7ffbffe          B.W      MODS_Poll
                  |L6.40|
;;;663        }
;;;664    }
000028  bd10              POP      {r4,pc}
;;;665    
                          ENDP

00002a  0000              DCW      0x0000
                  |L6.44|
                          DCD      0x40000c00
                  |L6.48|
                          DCD      ||.data||

                          AREA ||i.TIM5_Int_Init||, CODE, READONLY, ALIGN=2

                  TIM5_Int_Init PROC
;;;633    
;;;634    void TIM5_Int_Init(u16 arr,u16 psc)
000000  b57f              PUSH     {r0-r6,lr}
;;;635    {
000002  4604              MOV      r4,r0
000004  460d              MOV      r5,r1
;;;636        TIM_TimeBaseInitTypeDef TIM_TimeBaseInitStructure;
;;;637        NVIC_InitTypeDef NVIC_InitStructure;
;;;638        
;;;639        RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM5,ENABLE); //Ã™Ê¹Åœ TIM3 Ê±×“
000006  2101              MOVS     r1,#1
000008  2008              MOVS     r0,#8
00000a  f7fffffe          BL       RCC_APB1PeriphClockCmd
;;;640        TIM_TimeBaseInitStructure.TIM_Period = arr; //Ø”Ö¯×˜×°Õ˜Öµ
00000e  9402              STR      r4,[sp,#8]
;;;641        TIM_TimeBaseInitStructure.TIM_Prescaler=psc; //Ö¨Ê±Ç·Ø–Æµ
000010  f8ad5004          STRH     r5,[sp,#4]
;;;642        TIM_TimeBaseInitStructure.TIM_CounterMode=TIM_CounterMode_Up; //Ð²ÊÝ†Ë½Ä£Ê½
000014  2000              MOVS     r0,#0
000016  f8ad0006          STRH     r0,[sp,#6]
;;;643        TIM_TimeBaseInitStructure.TIM_ClockDivision=TIM_CKD_DIV1;
00001a  f8ad000c          STRH     r0,[sp,#0xc]
;;;644        TIM_TimeBaseInit(TIM5,&TIM_TimeBaseInitStructure);// ÃšÔµÊ¼Û¯Ö¨Ê±Ç· TIM3
00001e  4c0e              LDR      r4,|L7.88|
000020  a901              ADD      r1,sp,#4
000022  4620              MOV      r0,r4
000024  f7fffffe          BL       TIM_TimeBaseInit
;;;645        TIM_ITConfig(TIM5,TIM_IT_Update,ENABLE); //Ã›ÕŠÑ­Ö¨Ê±Ç· 3 Ù¼Ñ‚××
000028  2201              MOVS     r2,#1
00002a  4611              MOV      r1,r2
00002c  4620              MOV      r0,r4
00002e  f7fffffe          BL       TIM_ITConfig
;;;646        NVIC_InitStructure.NVIC_IRQChannel=TIM5_IRQn; //Ö¨Ê±Ç· 3 ××
000032  2132              MOVS     r1,#0x32
000034  f88d1000          STRB     r1,[sp,#0]
;;;647        NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority=0x01; //È€Õ¼Ô…ÐˆÜ¶ 1
000038  2101              MOVS     r1,#1
00003a  f88d1001          STRB     r1,[sp,#1]
;;;648        NVIC_InitStructure.NVIC_IRQChannelSubPriority=0x02; //Ð¬Ó¦Ô…ÐˆÜ¶ 3
00003e  2202              MOVS     r2,#2
000040  f88d2002          STRB     r2,[sp,#2]
;;;649        NVIC_InitStructure.NVIC_IRQChannelCmd=ENABLE;
000044  f88d1003          STRB     r1,[sp,#3]
;;;650        NVIC_Init(&NVIC_InitStructure);// ÃœÔµÊ¼Û¯ NVIC
000048  4668              MOV      r0,sp
00004a  f7fffffe          BL       NVIC_Init
;;;651        TIM_Cmd(TIM5,ENABLE); //ÃÊ¹ÅœÖ¨Ê±Ç· 3
00004e  2101              MOVS     r1,#1
000050  4620              MOV      r0,r4
000052  f7fffffe          BL       TIM_Cmd
;;;652    }
000056  bd7f              POP      {r0-r6,pc}
;;;653    
                          ENDP

                  |L7.88|
                          DCD      0x40000c00

                          AREA ||i.TIM6_Config||, CODE, READONLY, ALIGN=2

                  TIM6_Config PROC
;;;421    /*****************************************************************/
;;;422    void TIM6_Config(void)
000000  b53e              PUSH     {r1-r5,lr}
;;;423    {
;;;424    	TIM_TimeBaseInitTypeDef  TIM_TimeBaseStructure;
;;;425    	/* TIM3 µÄÅäÖÃ ---------------------------------------------------
;;;426       TIM3 ÊäÈëÊ±ÖÓ(TIM3CLK) ÉèÖÃÎª APB2 Ê±ÖÓ (PCLK2)    
;;;427        => TIM3CLK = PCLK2 = SystemCoreClock
;;;428       TIM3CLK = SystemCoreClock, Prescaler = 0, TIM3 counter clock = SystemCoreClock
;;;429       SystemCoreClock Îª48 MHz */
;;;430      /* TIM16 Ê±ÖÓÊ¹ÄÜ */
;;;431      RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM6,ENABLE);
000002  2101              MOVS     r1,#1
000004  2010              MOVS     r0,#0x10
000006  f7fffffe          BL       RCC_APB1PeriphClockCmd
;;;432    	
;;;433      /* Time ¶¨Ê±»ù´¡ÉèÖÃ*/
;;;434      TIM_TimeBaseStructure.TIM_Prescaler = 2;//Ê±ÖÓÔ¤·ÖÆµ
00000a  2002              MOVS     r0,#2
00000c  f8ad0000          STRH     r0,[sp,#0]
;;;435      TIM_TimeBaseStructure.TIM_CounterMode = TIM_CounterMode_Up;  /* Time ¶¨Ê±ÉèÖÃÎªÉÏÉýÑØ¼ÆËãÄ£Ê½*/
000010  2000              MOVS     r0,#0
000012  f8ad0002          STRH     r0,[sp,#2]
;;;436      TIM_TimeBaseStructure.TIM_Period = 0;
000016  9001              STR      r0,[sp,#4]
;;;437      TIM_TimeBaseStructure.TIM_ClockDivision = 0;
000018  f8ad0008          STRH     r0,[sp,#8]
;;;438      TIM_TimeBaseStructure.TIM_RepetitionCounter = 0;
00001c  f88d000a          STRB     r0,[sp,#0xa]
;;;439    
;;;440      TIM_TimeBaseInit(TIM6,&TIM_TimeBaseStructure);
000020  4c0a              LDR      r4,|L8.76|
000022  4669              MOV      r1,sp
000024  4620              MOV      r0,r4
000026  f7fffffe          BL       TIM_TimeBaseInit
;;;441    	TIM_ITConfig(TIM6,TIM_IT_Update,ENABLE);//¿ªÆô¶¨Ê±Æ÷¸üÐÂÖÐ¶Ï
00002a  2201              MOVS     r2,#1
00002c  4611              MOV      r1,r2
00002e  4620              MOV      r0,r4
000030  f7fffffe          BL       TIM_ITConfig
;;;442    	TIM_SetAutoreload(TIM6, 0xFF);//ÉèÖÃPWM·Ö±æÂÊ
000034  21ff              MOVS     r1,#0xff
000036  4620              MOV      r0,r4
000038  f7fffffe          BL       TIM_SetAutoreload
;;;443    	TIM6_NVIC_Config();
00003c  f7fffffe          BL       TIM6_NVIC_Config
;;;444      /* TIM3 ¼ÆËãÆ÷Ê¹ÄÜ*/
;;;445      TIM_Cmd(TIM6, ENABLE);
000040  2101              MOVS     r1,#1
000042  4620              MOV      r0,r4
000044  f7fffffe          BL       TIM_Cmd
;;;446    }
000048  bd3e              POP      {r1-r5,pc}
;;;447    /***********************************************************************/
                          ENDP

00004a  0000              DCW      0x0000
                  |L8.76|
                          DCD      0x40001000

                          AREA ||i.TIM6_NVIC_Config||, CODE, READONLY, ALIGN=1

                  TIM6_NVIC_Config PROC
;;;447    /***********************************************************************/
;;;448    static void TIM6_NVIC_Config(void)
000000  b508              PUSH     {r3,lr}
;;;449    {
;;;450    	NVIC_InitTypeDef NVIC_InitStructure; 
;;;451    	
;;;452    	/* Enable the USART1 Interrupt */
;;;453    	NVIC_InitStructure.NVIC_IRQChannel = TIM6_DAC_IRQn;	 
000002  2036              MOVS     r0,#0x36
000004  f88d0000          STRB     r0,[sp,#0]
;;;454    	NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 1;
000008  2001              MOVS     r0,#1
00000a  f88d0001          STRB     r0,[sp,#1]
;;;455    	NVIC_InitStructure.NVIC_IRQChannelSubPriority = 1;
00000e  f88d0002          STRB     r0,[sp,#2]
;;;456    	NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
000012  f88d0003          STRB     r0,[sp,#3]
;;;457    	NVIC_Init(&NVIC_InitStructure);
000016  4668              MOV      r0,sp
000018  f7fffffe          BL       NVIC_Init
;;;458    }
00001c  bd08              POP      {r3,pc}
;;;459    //????? 3 ?????
                          ENDP


                          AREA ||.data||, DATA, ALIGN=2

                  usartocflag
000000  00                DCB      0x00
                  usartshortflag
000001  00                DCB      0x00
                  resetflag
000002  0000              DCB      0x00,0x00
                  resetcount
000004  0000              DCB      0x00,0x00
                  uocount
000006  0000              DCB      0x00,0x00
                  powcount
000008  0000              DCB      0x00,0x00
                  powflag
00000a  0000              DCB      0x00,0x00
                  finishflag
00000c  00000000          DCB      0x00,0x00,0x00,0x00
                  Tick_10ms
                          DCD      0x00000000
                  crec1
                          DCD      0x00000000
                  crec2
                          DCD      0x00000000
                  testi
                          DCD      0x00000000
                  OldTick
                          DCD      0x00000000
                  shortv
                          DCD      0x00000000

                          AREA ||area_number.13||, DATA, ALIGN=1

                          EXPORTAS ||area_number.13||, ||.data||
                  battery_c
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.14||, DATA, ALIGN=2

                          EXPORTAS ||area_number.14||, ||.data||
                  bc_raw
                          DCD      0x00000000

                          AREA ||area_number.15||, DATA, ALIGN=2

                          EXPORTAS ||area_number.15||, ||.data||
                  cbc_raw
                          DCD      0x00000000

                          AREA ||area_number.16||, DATA, ALIGN=2

                          EXPORTAS ||area_number.16||, ||.data||
                  c_sum
                          DCD      0x00000000

                          AREA ||area_number.17||, DATA, ALIGN=0

                          EXPORTAS ||area_number.17||, ||.data||
                  resdone
000000  00                DCB      0x00

                          AREA ||area_number.18||, DATA, ALIGN=2

                          EXPORTAS ||area_number.18||, ||.data||
                  watch
                          DCD      0x00000000

;*** Start embedded assembler ***

#line 1 "..\\drive\\TIM6.c"
	AREA ||.rev16_text||, CODE
	THUMB
	EXPORT |__asm___6_TIM6_c_119e0187____REV16|
#line 129 "D:\\Keil_v5\\ARM\\CMSIS\\Include\\core_cmInstr.h"
|__asm___6_TIM6_c_119e0187____REV16| PROC
#line 130

 rev16 r0, r0
 bx lr
	ENDP
	AREA ||.revsh_text||, CODE
	THUMB
	EXPORT |__asm___6_TIM6_c_119e0187____REVSH|
#line 144
|__asm___6_TIM6_c_119e0187____REVSH| PROC
#line 145

 revsh r0, r0
 bx lr
	ENDP

;*** End   embedded assembler ***
